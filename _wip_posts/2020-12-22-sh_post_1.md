---
title: "Spherical Harmonics Basis Functions Part 1"
date: 2021-01-12
tags: [spherical-harmonics]
excerpt: "Detailed derivations of SH basis functions."
mathjax: "true"
comments_id: 4
---

*Disclaimer: The following proofs are not rigorous and skip over important steps to make the post easier to read. Full proofs can be found online.*

# Table of Contents

1. [Summary](#summary)
2. [Spherical Harmonics](#sh)
    1. [Definition](#def)
    2. [Properties]()
    3. [Examples]()


# Summary <a name="summary"></a>

This is part 1 in a series about spherical harmonics and their uses in rendering. This post will focus on the definition and properties of spherical harmonic basis functions. We will define a normalized version of spherical harmonics, show they form a basis and establish that they can approximate functions over the sphere. 


# Spherical Harmonics <a name="sh"></a>

## Definition  <a name="def"></a>

By [solving Laplace's equation](https://beatthezombie.github.io/laplace_equation_solution/) we found that the angular part is:

$$
Y_{\ell}^{m}(\theta, \varphi) = P_\ell^m(\cos\theta)e^{im\varphi}
$$

Where $\ell, m$ are integers, $m\geq 0$ and $-\ell \leq m \leq \ell$ and $P_{\ell}^{m}$ is the associated Legendre polynomial. We'll start by normalizing $Y_{\ell}^{m}(\theta, \varphi)$. Using the $L_2$ inner product and fixed $m$, it's possible to show that:

$$
\langle Y_{\ell}^{m},Y_{\ell'}^{m}   \rangle \int_{0}^{2\pi} \int_{0}^{\pi} Y_{\ell}^{m} (\theta, \varphi) Y_{\ell'}^{m}  (\theta, \varphi) \sin \theta d\theta d\varphi = \frac{4\pi}{2\ell + 1} \frac{(\ell + m)!}{(\ell - m)!} \delta_{\ell \ell'}
$$

Where $\delta_{\ell \ell'}$ is the Kronecker delta function, being 0 when $\ell \neq \ell'$ and 1 when $\ell = \ell'$. The proof of this statement can be found [here](https://www.physics.uoguelph.ca/chapter-4-spherical-harmonics) and relies on the orthogonality of the Legendre polynomials and the complex exponential. When $\ell = \ell'$, we have that 

$$
|| Y_{\ell}^{m} || = \sqrt{ \frac{4\pi}{2\ell + 1} \frac{(\ell + m)!}{(\ell - m)!}}
$$

To have a normalized definition, let's define $Y_{\ell}^{m}$ as:

$$
Y_{\ell}^{m}(\theta, \varphi) = (-1)^{m} \sqrt{ \frac{2\ell + 1}{4\pi} \frac{(\ell - m)!}{(\ell + m) }} P_\ell^m(\cos\theta)e^{im\varphi}
$$

The term $(-1)^{m}$ is used by convention in physics to simplify some equations. This definition is valid for $\ell \geq 0$, $-m \leq \ell \leq m$, having a special case for negative $m$ values:

$$
Y_{\ell}^{-m}(\theta, \varphi) = (-1)^m (Y_{\ell}^{m}(\theta, \varphi))^*
$$

This can be shown using this equation from the associated Legendre polynomials:

$$
P_\ell^{-m}(x) = (-1)^m \frac{(\ell-m)!}{(\ell+m)!}P_\ell^m(x)
$$

And the facts that complex conjugation of real functions is identity and $(e^{im\varphi})^* = e^{-im\varphi}$.

## Properties

### 1. Orthogonality

For fixed $m$, 










# References
- [https://en.wikipedia.org/wiki/Spherical_harmonics]()
-[https://www.physics.uoguelph.ca/chapter-3-legendre-polynomials]()
-[https://www.physics.uoguelph.ca/chapter-4-spherical-harmonics]()
 

